<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ARMEmulator.ViewModels"
        x:Class="ARMEmulator.Views.ExamplesBrowserWindow"
        x:DataType="vm:ExamplesBrowserViewModel"
        Title="Browse Examples"
        Width="900"
        Height="600"
        WindowStartupLocation="CenterOwner"
        Icon="/Assets/avalonia-logo.ico">

	<DockPanel>
		<!-- Action Buttons -->
		<StackPanel DockPanel.Dock="Bottom"
		            Orientation="Horizontal"
		            HorizontalAlignment="Right"
		            Margin="16"
		            Spacing="12">
			<Button Content="Cancel" MinWidth="80" Click="CancelButton_Click"
			        ToolTip.Tip="Close without loading" />
			<Button Content="Load" MinWidth="80" Click="LoadButton_Click"
			        IsEnabled="{Binding SelectedExample, Converter={x:Static ObjectConverters.IsNotNull}}"
			        IsDefault="True"
			        ToolTip.Tip="Load selected example into editor" />
		</StackPanel>

		<!-- Split View -->
		<Grid Margin="16">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="300" MinWidth="200" />
				<ColumnDefinition Width="5" />
				<ColumnDefinition Width="*" MinWidth="300" />
			</Grid.ColumnDefinitions>

			<!-- Left: Examples List -->
			<DockPanel Grid.Column="0">
				<!-- Search -->
				<TextBox DockPanel.Dock="Top"
				         Text="{Binding SearchText}"
				         Watermark="Search examples..."
				         Margin="0,0,0,8"
				         ToolTip.Tip="Filter examples by name or description" />

				<!-- Examples List -->
				<ListBox ItemsSource="{Binding FilteredExamples}"
				         SelectedItem="{Binding SelectedExample}">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<StackPanel Spacing="2">
								<TextBlock Text="{Binding Name}" FontWeight="SemiBold" />
								<TextBlock Text="{Binding Description}"
								           FontSize="11"
								           Foreground="{DynamicResource SystemBaseMediumColor}" />
								<TextBlock Text="{Binding Size, StringFormat='{}{0} bytes'}"
								           FontSize="10"
								           Foreground="{DynamicResource SystemBaseLowColor}" />
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>

				<!-- Empty state for filtered results -->
				<Border IsVisible="{Binding !FilteredExamples.Length}"
				        Padding="20"
				        VerticalAlignment="Center">
					<StackPanel Spacing="8" HorizontalAlignment="Center">
						<TextBlock Text="ðŸ” No examples found"
						           FontWeight="SemiBold"
						           HorizontalAlignment="Center" />
						<TextBlock Text="Try a different search term"
						           FontSize="11"
						           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
						           HorizontalAlignment="Center" />
					</StackPanel>
				</Border>
			</DockPanel>

			<!-- Splitter -->
			<GridSplitter Grid.Column="1" Width="5" />

			<!-- Right: Preview -->
			<DockPanel Grid.Column="2">
				<TextBlock DockPanel.Dock="Top" Text="Preview" FontWeight="SemiBold" Margin="0,0,0,8" />
				<TextBox Text="{Binding PreviewContent}"
				         IsReadOnly="True"
				         AcceptsReturn="True"
				         TextWrapping="NoWrap"
				         FontFamily="Consolas,Menlo,Monaco,monospace"
				         FontSize="12" />

				<!-- Empty state for no selection -->
				<Border IsVisible="{Binding !SelectedExample}"
				        Padding="20"
				        VerticalAlignment="Center">
					<StackPanel Spacing="8" HorizontalAlignment="Center">
						<TextBlock Text="Select an example to preview"
						           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
						           HorizontalAlignment="Center" />
					</StackPanel>
				</Border>
			</DockPanel>

			<!-- Loading Indicator -->
			<Border Grid.Column="0" Grid.ColumnSpan="3"
			        IsVisible="{Binding IsLoading}"
			        Background="{DynamicResource SystemControlBackgroundAltMediumBrush}"
			        Opacity="0.9">
				<StackPanel Spacing="12" HorizontalAlignment="Center" VerticalAlignment="Center">
					<ProgressBar IsIndeterminate="True" Width="200" />
					<TextBlock Text="Loading examples..."
					           HorizontalAlignment="Center"
					           FontWeight="SemiBold" />
				</StackPanel>
			</Border>

			<!-- Error Display -->
			<Border Grid.Column="0" Grid.ColumnSpan="3"
			        IsVisible="{Binding ErrorMessage, Converter={x:Static ObjectConverters.IsNotNull}}"
			        Background="{DynamicResource SystemControlBackgroundAltMediumBrush}"
			        Padding="40">
				<StackPanel Spacing="12" HorizontalAlignment="Center" VerticalAlignment="Center">
					<TextBlock Text="âš ï¸ Error Loading Examples"
					           FontWeight="SemiBold"
					           FontSize="16"
					           HorizontalAlignment="Center" />
					<TextBlock Text="{Binding ErrorMessage}"
					           TextWrapping="Wrap"
					           MaxWidth="400"
					           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
					           HorizontalAlignment="Center"
					           TextAlignment="Center" />
					<TextBlock Text="Check that the backend is running on http://localhost:8080"
					           FontSize="11"
					           FontStyle="Italic"
					           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
					           HorizontalAlignment="Center" />
				</StackPanel>
			</Border>
		</Grid>
	</DockPanel>
</Window>
